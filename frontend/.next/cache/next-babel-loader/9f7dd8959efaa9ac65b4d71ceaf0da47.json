{"ast":null,"code":"import _regeneratorRuntime from \"/home/jaybarnes/Desktop/Projects/forum/frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/jaybarnes/Desktop/Projects/forum/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$();\n\nimport useSWR from \"swr\";\nimport { useEffect, useState } from \"react\";\nimport makeSecuredRequest, { getNewToken } from \"../utils/makeSecuredRequest\";\n\nvar useUser = function useUser() {\n  _s();\n\n  var _useSWR = useSWR(\"/api/user\", makeSecuredRequest),\n      user = _useSWR.data,\n      error = _useSWR.error;\n\n  var _useState = useState(false),\n      authenticating = _useState[0],\n      setAuthenticating = _useState[1];\n\n  var _useState2 = useState(false),\n      isAuthenticated = _useState2[0],\n      setIsAuthenticated = _useState2[1];\n\n  useEffect(function () {\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              setAuthenticating(true);\n              _context.next = 4;\n              return getNewToken();\n\n            case 4:\n              setIsAuthenticated(true);\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0.response);\n\n            case 10:\n              _context.prev = 10;\n              return _context.finish(10);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7, 10, 12]]);\n    }))();\n  }, []);\n  return {\n    user: user,\n    error: error,\n    fetchingUser: !error && !user,\n    authenticating: authenticating,\n    isAuthenticated: isAuthenticated\n  };\n};\n\n_s(useUser, \"PIMaadczg2bzNKYVIIl5fMD9kpc=\", false, function () {\n  return [useSWR];\n});\n\nexport default useUser;","map":{"version":3,"sources":["/home/jaybarnes/Desktop/Projects/forum/frontend/hooks/useUser.ts"],"names":["useSWR","useEffect","useState","makeSecuredRequest","getNewToken","useUser","user","data","error","authenticating","setAuthenticating","isAuthenticated","setIsAuthenticated","console","log","response","fetchingUser"],"mappings":";;;;;AAAA,OAAOA,MAAP,MAAmB,KAAnB;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AAEA,OAAOC,kBAAP,IAA6BC,WAA7B,QAAgD,6BAAhD;;AAEA,IAAMC,OAAO,GAAG,SAAVA,OAAU,GAAM;AAAA;;AAAA,gBACUL,MAAM,CAAC,WAAD,EAAcG,kBAAd,CADhB;AAAA,MACNG,IADM,WACZC,IADY;AAAA,MACAC,KADA,WACAA,KADA;;AAAA,kBAGwBN,QAAQ,CAAC,KAAD,CAHhC;AAAA,MAGbO,cAHa;AAAA,MAGGC,iBAHH;;AAAA,mBAI0BR,QAAQ,CAAC,KAAD,CAJlC;AAAA,MAIbS,eAJa;AAAA,MAIIC,kBAJJ;;AAMpBX,EAAAA,SAAS,CAAC,YAAM;AACd,6DAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAEGS,cAAAA,iBAAiB,CAAC,IAAD,CAAjB;AAFH;AAAA,qBAISN,WAAW,EAJpB;;AAAA;AAKGQ,cAAAA,kBAAkB,CAAC,IAAD,CAAlB;AALH;AAAA;;AAAA;AAAA;AAAA;AAOGC,cAAAA,OAAO,CAACC,GAAR,CAAY,YAAMC,QAAlB;;AAPH;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;AAYD,GAbQ,EAaN,EAbM,CAAT;AAeA,SAAO;AACLT,IAAAA,IAAI,EAAJA,IADK;AAELE,IAAAA,KAAK,EAALA,KAFK;AAGLQ,IAAAA,YAAY,EAAE,CAACR,KAAD,IAAU,CAACF,IAHpB;AAILG,IAAAA,cAAc,EAAdA,cAJK;AAKLE,IAAAA,eAAe,EAAfA;AALK,GAAP;AAOD,CA5BD;;GAAMN,O;UAC0BL,M;;;AA6BhC,eAAeK,OAAf","sourcesContent":["import useSWR from \"swr\";\nimport { useEffect, useState } from \"react\";\nimport { setAccessToken } from \"../token\";\nimport makeSecuredRequest, { getNewToken } from \"../utils/makeSecuredRequest\";\n\nconst useUser = () => {\n  const { data: user, error } = useSWR(\"/api/user\", makeSecuredRequest);\n\n  const [authenticating, setAuthenticating] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        setAuthenticating(true);\n\n        await getNewToken();\n        setIsAuthenticated(true);\n      } catch (error) {\n        console.log(error.response);\n      } finally {\n        // setAuthenticating(false);\n      }\n    })();\n  }, []);\n\n  return {\n    user,\n    error,\n    fetchingUser: !error && !user,\n    authenticating,\n    isAuthenticated,\n  };\n};\n\nexport default useUser;\n"]},"metadata":{},"sourceType":"module"}